{% extends "base.html" %}
{% block title %}Share link{% endblock %}
{% block content %}
  <p><a href="{{ url_for('browse') }}" class="view-back">Back to browse</a></p>
  <h1 class="browse-heading">Share link</h1>
  <p class="browse-path">Path: {{ path }}</p>
  <div class="share-card">
    <form method="post" action="{{ url_for('share') }}" class="share-form">
      <input type="hidden" name="path" value="{{ path }}">
      <fieldset class="share-fieldset">
        <legend>Expiration</legend>
        <label><input type="radio" name="expires" value="default" checked> Default</label>
        <label><input type="radio" name="expires" value="never"> Never</label>
        <label><input type="radio" name="expires" value="custom"> Custom</label>
        <span class="share-custom-row">
          <input type="number" name="custom_value" min="1" value="24" size="4">
          <select name="custom_unit">
            <option value="hours">hours</option>
            <option value="days">days</option>
          </select>
        </span>
      </fieldset>
      <p><button type="submit" class="share-submit">Get link</button></p>
    </form>
  </div>
{% endblock %}
{% block scripts %}
  {{ super() }}
  <script>
    (function() {
      var form = document.querySelector(".share-form");
      if (!form) return;
      var customRow = form.querySelector(".share-custom-row");
      var radios = form.querySelectorAll("input[name=expires]");
      function updateCustomVisibility() {
        var custom = form.querySelector("input[name=expires][value=custom]");
        if (customRow && custom) customRow.style.display = custom.checked ? "inline-flex" : "none";
      }
      radios.forEach(function(r) { r.addEventListener("change", updateCustomVisibility); });
      updateCustomVisibility();
    })();
  </script>
{% endblock %}
